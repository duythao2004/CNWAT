<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <base href="/CNWAT/" />
    <title>Bài 3 – 2.5 Form nhập (Đăng ký)</title>
    <link rel="stylesheet" href="bt2/css/style.css" />
    <style>
      /* layout nhỏ cho form theo gợi ý đề */
      .dk-card {
        max-width: 780px;
        margin: 0 auto;
      }
      .row {
        display: grid;
        grid-template-columns: 160px 1fr 1fr;
        gap: 10px;
        align-items: center;
        margin: 8px 0;
      }
      .row label {
        align-self: start;
      }
      .row input[type="text"],
      .row input[type="password"],
      .row input[type="email"],
      .row textarea {
        width: 100%;
        padding: 8px 10px;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
      }
      .req input,
      .req textarea {
        background: #d1fae5;
      } /* ô bắt buộc nền xanh nhạt */
      .hint {
        color: #6b7280;
        font-size: 12px;
      }
      .err {
        color: #dc2626;
        font-size: 13px;
      }
      .ok {
        color: #16a34a;
        font-weight: 600;
      }
      .btns {
        margin-top: 12px;
        display: flex;
        gap: 8px;
      }
      .btn {
        padding: 8px 12px;
        border: 1px solid #e5e7eb;
        border-radius: 10px;
        background: #f8fafc;
        cursor: pointer;
      }
      .muted {
        color: #6b7280;
      }
      .inline {
        display: flex;
        gap: 12px;
        align-items: center;
      }
      .gray {
        color: #6b7280;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <!-- cột trái -->
      <section class="student">
        <div class="avatar"><img src="bt2/assets/img/me.jpg" alt="" /></div>
        <div>
          <h3>Thông tin sinh viên</h3>
          <p><strong>Họ và tên:</strong> Nguyễn Duy Thảo</p>
          <p><strong>MSSV:</strong> AT190351</p>
        </div>
      </section>

      <!-- banner -->
      <header class="banner banner--video">
        <video
          class="banner-video"
          autoplay
          muted
          loop
          playsinline
          poster="bt2/assets/img/banner-poster.jpg"
        >
          <source src="bt2/assets/video/banner.webm" type="video/webm" />
          <source src="bt2/assets/video/banner.mp4" type="video/mp4" />
        </video>
      </header>

      <!-- menu trái -->
      <nav class="menu" aria-label="Menu">
        <h4>Menu</h4>
        <ul>
          <li><a href="bt2/index.html">Trang chủ</a></li>
          <li>
            <a href="bt2/gioi-thieu-ban-than.html">1.1 Giới thiệu bản thân</a>
          </li>
          <li><a href="bt2/bang-diem.html">1.2 Bảng điểm</a></li>
          <li><a href="bt2/ly-lich.html">1.3 Lý lịch</a></li>
          <li><a href="bt2/tin-tuc.html">1.4 Tin tức</a></li>
          <li><a href="bt3/vidu.html">2.1 Ví dụ JS</a></li>
          <li><a href="bt3/trac-nghiem.html">2.2 Thi trắc nghiệm</a></li>
          <li><a href="bt3/nhap-lop.html">2.3 Nhập LOP</a></li>
          <li><a href="bt3/nhap-hoso.html">2.4 Hồ sơ</a></li>
          <li>
            <a class="active" href="bt3/form-dang-ky.html">2.5 Form đăng ký</a>
          </li>
          <li><a href="bt3/danh-sach.html">2.6 Danh sách</a></li>
          <li><a href="bt3/thuc-don.html">2.7 Thực đơn</a></li>
          <li><a href="bt3/tab.html">2.8 Tab</a></li>
          <li><a href="bt3/cay.html">2.9 Cây</a></li>
          <li><a href="bt3/may-tinh.html">2.10. Máy tính</a></li>
          <li><a href="bt3/hoat-anh.html">2.11 Hoạt ảnh</a></li>
          <li><a href="bt3/sap-xep.html">2.12 Sắp xếp</a></li>
        </ul>
      </nav>

      <!-- MAIN -->
      <main class="main card dk-card">
        <h1>Đăng ký thành viên</h1>
        <p class="muted">
          Các ô <span class="gray">nền xanh</span> là bắt buộc. Nhấn
          <b>Enter</b> để chuyển nhanh sang ô kế tiếp.
        </p>

        <form id="f" novalidate>
          <div class="row req">
            <label for="hoten">Họ và tên</label>
            <input
              id="hoten"
              name="hoten"
              type="text"
              autocomplete="name"
              placeholder="VD: nguyễn   duy  thảo"
            />
            <span id="e-hoten" class="err"></span>
          </div>

          <div class="row">
            <label>Giới tính</label>
            <div class="inline">
              <label
                ><input type="radio" name="gt" value="Nam" checked /> Nam</label
              >
              <label><input type="radio" name="gt" value="Nữ" /> Nữ</label>
            </div>
            <span></span>
          </div>

          <div class="row req">
            <label for="ngaysinh">Ngày sinh</label>
            <input
              id="ngaysinh"
              name="ngaysinh"
              type="text"
              placeholder="nn/tt/nnnn"
              value="nn/tt/nnnn"
              class="gray"
            />
            <span id="e-ngaysinh" class="err"></span>
            <div class="hint" style="grid-column: 2/4">
              Định dạng: <code>dd/mm/yyyy</code>. Khi focus sẽ tô xám; tự chèn
              dấu <code>/</code> ở vị trí 3 và 6.
            </div>
          </div>

          <div class="row req">
            <label for="email">Email</label>
            <input
              id="email"
              name="email"
              type="email"
              placeholder="ten*@ten*.ten*"
            />
            <span id="e-email" class="err"></span>
          </div>

          <div class="row">
            <label>Sở thích / Ngành</label>
            <div class="inline" style="flex-wrap: wrap">
              <label
                ><input type="checkbox" name="nganh" value="Tiếng Anh" /> Tiếng
                Anh</label
              >
              <label
                ><input type="checkbox" name="nganh" value="Quản trị" /> Quản
                trị</label
              >
              <label
                ><input type="checkbox" name="nganh" value="CNTT" /> CNTT</label
              >
            </div>
            <span></span>
          </div>

          <div class="row req">
            <label for="mk">Mật khẩu</label>
            <input id="mk" name="mk" type="password" />
            <span id="e-mk" class="err"></span>
          </div>

          <div class="row req">
            <label for="mk2">Gõ lại mật khẩu</label>
            <input id="mk2" name="mk2" type="password" />
            <span id="e-mk2" class="err"></span>
          </div>

          <div class="row">
            <label for="ghichu">Ghi chú</label>
            <textarea
              id="ghichu"
              name="ghichu"
              rows="3"
              placeholder="(không bắt buộc)"
            ></textarea>
            <span></span>
          </div>

          <div class="btns">
            <button type="button" id="btnOk" class="btn">Chấp nhận</button>
            <button type="reset" id="btnReset" class="btn">Bỏ qua</button>
          </div>
        </form>

        <p id="msg" class="ok"></p>
      </main>

      <footer class="footer">Thông tin bản quyền – © 2025</footer>
    </div>

    <script>
      /* ======== tiện ích ======== */
      const $ = (id) => document.getElementById(id);
      const err = (id, msg = "") => ($(id).textContent = msg);

      /* Chuẩn hoá họ tên: bỏ khoảng trắng thừa, viết hoa chữ cái đầu */
      function normalizeName(s) {
        return s
          .normalize("NFC")
          .trim()
          .split(/\s+/)
          .map((w) => w.charAt(0).toUpperCase() + w.slice(1).toLowerCase())
          .join(" ");
      }

      /* Kiểm tra email: len*@len*.len* */
      const emailRe = /^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/;

      /* Kiểm tra ngày dd/mm/yyyy hợp lệ */
      function validDMY(v) {
        const m = /^(\d{2})\/(\d{2})\/(\d{4})$/.exec(v);
        if (!m) return false;
        const d = +m[1],
          mo = +m[2] - 1,
          y = +m[3];
        const dt = new Date(y, mo, d);
        return (
          dt.getFullYear() == y && dt.getMonth() == mo && dt.getDate() == d
        );
      }

      /* ======== gắn sự kiện theo yêu cầu ======== */
      const f = document.getElementById("f");
      const hoten = $("hoten");
      const ngaysinh = $("ngaysinh");
      const email = $("email");
      const mk = $("mk");
      const mk2 = $("mk2");
      const msg = $("msg");

      /* 1) đặt tầm điểm vào Họ tên khi vào trang */
      window.addEventListener("DOMContentLoaded", () => hoten.focus());

      /* 2) Enter chuyển sang ô kế tiếp */
      f.addEventListener("keyup", (e) => {
        if (e.key === "Enter") {
          const inputs = Array.from(f.querySelectorAll("input, textarea"));
          const i = inputs.indexOf(e.target);
          if (i >= 0 && i < inputs.length - 1) inputs[i + 1].focus();
        }
      });

      /* 3) blur ở Họ tên → chuẩn hoá */
      hoten.addEventListener("blur", () => {
        hoten.value = normalizeName(hoten.value);
      });

      /* 4) focus/blur ở Ngày sinh: đổi màu xám, xử lý placeholder */
      const PLACEHOLDER = "nn/tt/nnnn";
      ngaysinh.addEventListener("focus", () => {
        if (ngaysinh.value === PLACEHOLDER) {
          ngaysinh.value = "";
        }
        ngaysinh.classList.add("gray");
      });
      ngaysinh.addEventListener("blur", () => {
        ngaysinh.classList.remove("gray");
        if (!ngaysinh.value) ngaysinh.value = PLACEHOLDER;
      });

      /* 5) keyup ở Ngày sinh: tự chèn '/' và chỉ cho số */
      ngaysinh.addEventListener("input", () => {
        let v = ngaysinh.value.replace(/[^\d]/g, "");
        if (v.length > 2) v = v.slice(0, 2) + "/" + v.slice(2);
        if (v.length > 5) v = v.slice(0, 5) + "/" + v.slice(5, 9);
        ngaysinh.value = v;
      });

      /* 6) Bấm Chấp nhận: kiểm tra tất cả ràng buộc */
      $("btnOk").addEventListener("click", () => {
        msg.textContent = "";
        let ok = true;

        // Họ tên
        if (!hoten.value.trim()) {
          err("e-hoten", "Vui lòng nhập họ và tên.");
          ok = false;
        } else {
          err("e-hoten");
        }

        // Ngày sinh
        const ns = ngaysinh.value.trim();
        if (!validDMY(ns)) {
          err("e-ngaysinh", "Ngày sinh không hợp lệ (đúng mẫu dd/mm/yyyy).");
          ok = false;
        } else {
          err("e-ngaysinh");
        }

        // Email
        if (!emailRe.test(email.value.trim())) {
          err("e-email", "Email không đúng định dạng len*@len*.len*");
          ok = false;
        } else {
          err("e-email");
        }

        // Mật khẩu
        if (!mk.value) {
          err("e-mk", "Vui lòng nhập mật khẩu.");
          ok = false;
        } else {
          err("e-mk");
        }

        // Gõ lại mật khẩu
        if (mk2.value !== mk.value) {
          err("e-mk2", "Mật khẩu gõ lại không đúng.");
          ok = false;
        } else {
          err("e-mk2");
        }

        if (!ok) return;

        // Nếu hợp lệ → hiển thị tóm tắt (trừ mật khẩu & điện thoại… như đề)
        const gt =
          (f.querySelector('input[name="gt"]:checked') || {}).value || "";
        const nganh =
          Array.from(f.querySelectorAll('input[name="nganh"]:checked'))
            .map((i) => i.value)
            .join(", ") || "(không chọn)";
        msg.innerHTML = `✔ Đăng ký hợp lệ. <br>
    Họ tên: <b>${hoten.value}</b> – Giới tính: <b>${gt}</b> – Ngày sinh: <b>${ns}</b> <br>
    Email: <b>${email.value}</b> – Ngành/Sở thích: <b>${nganh}</b>`;
      });

      /* 7) Reset: xoá lỗi & phục hồi placeholder */
      $("btnReset").addEventListener("click", () => {
        ["e-hoten", "e-ngaysinh", "e-email", "e-mk", "e-mk2"].forEach((id) =>
          err(id, "")
        );
        msg.textContent = "";
        setTimeout(() => {
          ngaysinh.value = PLACEHOLDER;
        });
      });
    </script>
  </body>
</html>
